
<div class="espacio">
  <div *ngIf="(ErrorMessage != null || ErrorMessage != undefined )" class="alert alert-danger" id="danger">
    <strong>{{ErrorMessage}}</strong>
  </div>
</div>

<div *ngIf="Mostrar">
  <div class="row">
    <!--Datos de la evaluación-->


    <div class="ml-2 pl-5 col-xs-12 col-sm-3 col-md-3 mt-5" *ngIf="mostrarCheckboxes">
      <div class="checkbox">
        <form>
          <div>
            <input type="checkbox" id="notasEv" name="notasEv" value=""
                   [ngClass]="{'disableCheck': Evaluacion.notasEv == null || Evaluacion.notasEv.length == '0'}" (click)="cambiarMostrarNotasEv()" />
            <label for="notasEv" [ngClass]="{'disable': Evaluacion.notasEv == null || Evaluacion.notasEv.length == '0'}">
              <span><!-- This span is needed to create the "checkbox" element --></span>
              Notas de evaluación
            </label>
          </div>
        </form>
      </div>

      <div class="checkbox">
        <form>
          <div>
            <input type="checkbox" id="notasOb" name="notasOb" value=""
                   [ngClass]="{'disableCheck': Evaluacion.notasOb == null || Evaluacion.notasOb.length == '0'}" (click)="cambiarMostrarNotasOb()" />
            <label for="notasOb" [ngClass]="{'disable': Evaluacion.notasOb == null || Evaluacion.notasOb.length == '0'}">
              <span><!-- This span is needed to create the "checkbox" element --></span>
              Notas de objetivos
            </label>
          </div>
        </form>
      </div>

      <div class="checkbox">
        <form>
          <div>
            <input type="checkbox" id="notasSec" name="notasSec" value=""
                   [ngClass]="{'disableCheck': !Evaluacion.flagNotasSec}" (click)="cambiarMostrarNotasSec()" />
            <label for="notasSec" [ngClass]="{'disable': !Evaluacion.flagNotasSec}">
              <span><!-- This span is needed to create the "checkbox" element --></span>
              Notas de secciones
            </label>
          </div>
        </form>
      </div>


      <div class="checkbox">
        <form>
          <div>
            <input type="checkbox" id="notasAsig" name="notasAsig" value=""
                   [ngClass]="{'disableCheck': !Evaluacion.flagNotasAsig}" (click)="cambiarMostrarNotasAsig()" />
            <label for="notasAsig" [ngClass]="{'disable': !Evaluacion.flagNotasAsig}">
              <span><!-- This span is needed to create the "checkbox" element --></span>
              Notas de asignaciones
            </label>
          </div>
        </form>
      </div>

      <div class="checkbox">
        <form>
          <div>
            <input type="checkbox" id="notasPreg" name="notasPreg" value=""
                   [ngClass]="{'disableCheck': !Evaluacion.flagNotasPreg}" (click)="cambiarMostrarNotasPreg()" />
            <label for="notasPreg" [ngClass]="{'disable': !Evaluacion.flagNotasPreg}">
              <span><!-- This span is needed to create the "checkbox" element --></span>
              Notas de preguntas
            </label>
          </div>
        </form>
      </div>
    </div>

    <!--Tabla con datos--->
    <div class="col-xs-12 col-sm-6 col-md-6 mt-3">

      <div id="printcanvas">
        <div class="data mb-2">
          Proyecto: <b>{{Evaluacion.nombre}}</b>
          <br />
          Fecha: <b>{{Evaluacion.fecha | date:'dd/MM/yyyy'}}</b>
        </div>

        <table class="table-fill" style="overflow-x:auto;">
          <thead>
            <tr>
              <th class="text-left">Asignaciones</th>
              <th class="text-left">Puntuación</th>
            </tr>
          </thead>
          <tbody class="table-hover">
            <tr *ngFor="let datos of ListaDeDatos">
              <td class="text-left">{{datos.nombre | titlecase}}</td>
              <td class="text-left">{{datos.respuestasCorrectas}}%</td>
            </tr>
          </tbody>
        </table>


        <div class="cajaNotas row text-center mt-4">
          <div class="notas mx-auto col-12" *ngIf="mostrarNotasEv">
            <h4>Notas de evaluación:</h4>
            <p>{{Evaluacion.notasEv}}</p>
          </div>

          <div class="notas mx-auto col-12" *ngIf="mostrarNotasOb">
            <h4>Notas de objetivos:</h4>
            <p>{{Evaluacion.notasOb}}</p>
          </div>

          <div class="notas mx-auto col-12" *ngIf="mostrarNotasSec">
            <h4>Notas de secciones:</h4>
            <div *ngFor="let datos of ListaDeDatos">
              <div *ngIf="datos.notas != null && datos.notas != ''">
                <strong>{{datos.nombre | titlecase}}</strong>
                <p>{{datos.notas}}</p>
              </div>
            </div>

          </div>


          <div class="notas mx-auto col-12" *ngIf="mostrarNotasAsig">
            <h4>Notas de asignaciones:</h4>

            <table class="table-fill" style="overflow-x:auto;">
              <thead>
                <tr>
                  <th class="text-left">Sección</th>
                  <th class="text-left">Asignación</th>
                  <th class="text-left">Notas</th>
                </tr>
              </thead>
              <tbody class="table-hover">
                <tr *ngFor="let asig of ListaDeAsignaciones">
                  <td class="text-left notasPreg" *ngIf="asig.notas != null && asig.notas != ''">{{asig.section | titlecase}}</td>
                  <td class="text-left notasPreg" *ngIf="asig.notas != null && asig.notas != ''">{{asig.asignacion}}</td>
                  <td class="text-left notasPreg" *ngIf="asig.notas != null && asig.notas != ''">{{asig.notas}}</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div *ngIf="cargandoNotas">
            <app-loading></app-loading>
          </div>


          <div class="notas mx-auto col-12" *ngIf="mostrarNotasPreg">
            <h4>Notas de preguntas:</h4>

            <table class="table-fill" style="overflow-x:auto;">
              <thead>
                <tr>
                  <th class="text-left">Sección</th>
                  <th class="text-left">Asignación</th>
                  <th class="text-left">Pregunta</th>
                  <th class="text-left">Respuesta</th>
                  <th class="text-left">Notas</th>
                </tr>
              </thead>
              <tbody class="table-hover">
                <tr *ngFor="let respuesta of ListaDeRespuestas">
                  <td class="text-left notasPreg" *ngIf="respuesta.notas != null && respuesta.notas != ''">{{respuesta.section | titlecase}}</td>
                  <td class="text-left notasPreg" *ngIf="respuesta.notas != null && respuesta.notas != ''">{{respuesta.asignacion}}</td>
                  <td class="text-left notasPreg" *ngIf="respuesta.notas != null && respuesta.notas != ''">{{respuesta.pregunta}}</td>
                  <td class="text-left notasPreg ncResp" *ngIf="respuesta.notas != null && respuesta.notas != ''">
                    <span *ngIf="respuesta.estado == 0">No contestada</span>
                    <span *ngIf="respuesta.estado == 1">Sí</span>
                    <span *ngIf="respuesta.estado == 2">No</span>
                  </td>
                  <td class="text-left notasPreg" *ngIf="respuesta.notas != null && respuesta.notas != ''">{{respuesta.notas}}</td>
                </tr>
              </tbody>
            </table>
          </div>

        </div>


        <!--Grafica->
    <div style="display: block" id="Grafica">
      <canvas id="canvas" baseChart
              [datasets]="barChartData"
              [labels]="ListaNombres"
              [options]="barChartOptions"
              [legend]="barChartLegend"
              [chartType]="barChartType"
              (chartHover)="chartHovered($event)"></canvas>
    </div>
  </!--div-->

      </div>
      <div class="center mt-3">
        <button class="btn btn-outline-success" id="no-print" (click)="downloadPDF()" media="print">Generar PDF</button>
      </div>
      <div class="center mt-4">
        <button type="button" class="btn btn-info" (click)="Volver('/evaluacionprevia')">Evaluaciones</button>
        <button type="button" class="btn btn-secondary" (click)="Volver('/home')">Inicio</button>
      </div>
    </div>

    <div class="col-xs-12 col-sm-3 col-md-3"></div>

  </div>

</div>


<div *ngIf="!Mostrar" class="mt-3">
  <app-loading></app-loading>
</div>





